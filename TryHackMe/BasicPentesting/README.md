
# ğŸ”µ Basic Pentesting â€“ TryHackMe

## ğŸ“Œ Overview

This room focuses on fundamental penetration testing techniques including enumeration, service discovery, brute-forcing, and privilege escalation.

---

## ğŸ¯ Objectives

- Perform network enumeration
- Identify exposed services
- Gain initial access
- Escalate privileges

---

## ğŸ” Step 1 â€“ Reconnaissance (Information Gathering)

**The Concept**: This is the most important step. You can't attack what you don't know. We're going to scan the machine to find open "doors" (ports) and understand what services are running behind them.

### 1.1 Port Scanning with Nmap

**The Tool**: `nmap` (Network Mapper) is the standard for network exploration.

### 1.2 Analysis of Scan Results

**Command Executed**: `nmap -sC -sV -oN scan_nmap.txt 10.66.134.234`

**Why this command?**

- `-sC`: Activates default detection scripts (common vulnerabilities, web page titles).
- `-sV`: "Service Version". Queries services to get their exact name and version (essential for finding specific vulnerabilities).
- `-oN ...`: "Output Normal". Saves the results to a text file for later review.

```
result
```

**What we found**:

The scan revealed several open doors (ports). Here's the detailed analysis:

1.  **Port 22 (SSH - OpenSSH 8.2p1)**
    *   **What is it?**: Secure Shell. It's the standard protocol for remotely administering a Linux server via command line.
    *   **Interest for us**: If we find a username and password, we've won; we'll have direct access to the system.

2.  **Port 80 (HTTP - Apache httpd 2.4.41)**
    *   **What is it?**: It's the standard web server hosting a website.
    *   **Interest for us**: Websites are nests of vulnerabilities (text fields, admin panels, forgotten files). This is often our main entry point.

3.  **Ports 139 & 445 (SMB - Samba)**
    *   **What is it?**: This is Windows' "Network Neighborhood" protocol, but here it's running on Linux thanks to "Samba". It's used for sharing files and printers.
    *   **Interest for us**: Administrators often leave shares open to "Everyone" (Anonymous) or files containing passwords.

4.  **Port 8080 (HTTP - Apache Tomcat 9.0.7)**
    *   **What is it?**: Another web server. Tomcat is specialized for running Java applications (JSP).
    *   **Interest for us**: There's often a management interface (manager) which, if poorly protected (default passwords like admin/admin), allows for total control of the server.

**Strategy Summary**:

We have three main leads to explore (Medium and High priority):

- **Lead A (Web)**: Go check out the site on port 80.
- **Lead B (SMB)**: Check if we can access shares without a password.
- **Lead C (Tomcat)**: See what's running on port 8080.

---

## Step 2: Enumeration

**The Concept**: Once the doors are found, we'll knock on them one by one to see what we can find inside.

### 3.1 Web Enumeration (Port 80 - Apache)

Here we are asked to check the dev note to know what to do.

So we're going to look for hidden directories by trying common directory and file names like /dev, /admin, /admin.php.

**Screenshot (Port 80 Homepage)**:

```
result
```

Inspect the page to see if we can find info in the source code.

```
result
```
**The Tool**: `gobuster` (or `dirb/dirbuster`).

This is a tool that will try thousands of common folder names (like `/admin`, `/login`, `/backup`) to see if the server responds "OK" (Code 200) or "Forbidden" (Code 403), instead of "Not Found" (Code 404).

This is called directory brute-forcing.

**Our Command**: `gobuster dir -u [http://10.80.188.54](http://10.80.188.54) -w /usr/share/wordlists/dirb/common.txt`

- `dir`: "Directory search" mode.
- `-u`: The target URL.
- `-w`: The "Wordlist". This is the dictionary of words the tool will test one by one.

```
result
```

*Gobuster found an interesting directory:*

- `/development` (Code 301 - Redirection)

This suggests a developers' work area. This is often where you find notes (`notes.txt`), backups, or forgotten configuration files.

**Screenshot (/development Directory)**:

```
result
```

**Next Action**: Explore `http://10.65.146.76/development/` to see its contents.

### 3.2 Analysis of Discovered Files

In the `/development` directory, we found two text files that we downloaded: `dev.txt` and `j.txt`.

**Contents of `dev.txt`**:

```
result
```
```
result
```

> "2018-04-23: I've been messing with that **struts stuff**, and it's pretty cool! I think it might be neat to host that on this server too.... Oh, and right now I'm using **version 2.5.12**" - K

**Analysis**:

- **Critical Information**: The server uses (or is testing) **Apache Struts 2.5.12**.
- **Why is this important?**: Apache Struts has a history of critical security vulnerabilities (RCE). Version 2.5.12 is old and likely vulnerable.

**Contents of `j.txt`**:

```
result
```

> "For J: I've been auditing the contents of /etc/shadow [...] and I was able to crack your hash really easily. [...] Change that password ASAP." - K

**Analysis**:

- **Potential Users**: "J" and "K".
- **Weakness**: User "J" has a very weak password (easy to crack).

**New Strategy**:

1.  Look for exploits for **Apache Struts 2.5.12**.
2.  Try to guess "J's" password (SSH brute-force?) if we don't find another entry point.

### 3.3 SMB Services (Port 139/445)

**The Concept**: SMB (Server Message Block) allows file sharing over the network.

**Objective**: Check if any shares are accessible without a password ("Anonymous") and what they contain.

**Commands Used**:

1. `smbclient -L //10.65.146.76 -N`
   - **Why?**: List (`-L`) the available shares on the machine.
   - `-N`: "No password". Attempts to connect without a password (anonymously).

```
result
```

To get more info, we'll use enum4linux.

2. `enum4linux -a 10.65.146.76`
   - **Why?**: All-in-one tool for scanning Windows/Samba systems.
   - `-a`: "All". Runs all tests (users, groups, shares, password policy).

```
result
```

3. `smbclient //10.65.146.76/Anonymous -N`
   - **Why?**: Connect specifically to the found share (`Anonymous`) to view files.

**Results**:

- **Shares Discovered**: A share named `Anonymous` is listed.
- **Access**: It appears accessible without a password (since it was listed with the `-N` option).

```
result
```

**Results**:

- **Shares Discovered**: A share named `Anonymous` is listed.
- **Access**: It appears accessible without a password (since it was listed with the `-N` option).
- **Contents**: A file `staff.txt` was found.

**Analysis of `staff.txt`**:

> "PLEASE do not upload non-work-related items to this share. [...] (This means you too, **Jan**!) - **Kay**"

```
result
```

**Enumeration Synthesis (Web + SMB)**:

We have cross-referenced the information:

1.  **Web (`j.txt`)**: "J" has a weak password.
2.  **SMB (`staff.txt`)**: The first name "Jan" is explicitly mentioned, as well as "Kay".

**Conclusion**: The user **jan** exists on the system and has a weak password.

---

## Step 3: Exploitation

**The Concept**: Use a found vulnerability to enter the system.

### 3.1 Brute Force Attack (SSH)

**The Target**: The user `jan`.

**The Vulnerability**: Weak password (confirmed by Kay).

**The Tool**: `hydra`. It's a very fast tool that will test a list of common passwords (wordlist) against the SSH service.

**Our Command**: `hydra -l jan -P /usr/share/wordlists/rockyou.txt ssh://10.65.146.76`

- `-l jan`: The login to test.
- `-P Wordlist`: The list of passwords (here `rockyou.txt`, the most famous one).
- `ssh://...`: The target protocol and IP.
- `-t 4`: Number of parallel attempts (threads).

```
result
```

Success! Hydra found the valid password.

- **User**: `jan`
- **Password**: `armando`

### 3.2 Initial Connection (Shell)

We can now connect to the server as `jan`.

**Command**: `ssh jan@10.65.146.76`

(Password: `armando`)

```
result
```

**Why?**:

We use the standard SSH client to open an interactive session (shell) on the remote machine.

**Immediate Objective**:

1.  Verify who we are (`whoami`).
2.  Look for the "User Flag" (often `user.txt`).

*Connection successful.*

### 3.3 Post-Exploitation Enumeration

**Commands**:

- `whoami`: Displays our current username (`jan`).
- `sudo -l`: "List". Displays the commands we are allowed to run as admin (root) with sudo.
```
result
```
  - *Result*: **Access denied**. User `jan` can't do anything.

**System Exploration**:

- `/home` directory:
    - `jan` (Our user)
    - `kay` (Potential target) - Contains a `pass.bak` file and a `.ssh` folder.
    - `ubuntu`

**Privilege Escalation Strategy**:

Since we can't use `sudo`, we need to find another way to become `root` or `kay`.

- Check if we can steal `kay`'s SSH key.
- 
```
result
```

### 3.4 SSH Key Theft (Privilege Escalation)

We found `kay`'s private SSH key in `/home/kay/.ssh/id_rsa` (readable by everyone!).

`scp jan@10.66.134.234:/home/kay/.ssh/id_rsa ~/Desktop/basic_pentesting`

```
result
```

Attempt to connect with the key.
Set file permissions to 600.

```
result
```

The key was protected by a "passphrase".

**Cracking Process**:

1.  **Hash Extraction**:
    `ssh2john kay_id_rsa > kay.hash`
    - **Why?**: `John the Ripper` can't read an SSH key directly. `ssh2john` converts it into a format ("hash") that John can attack.

```
result
```

2.  **Bruteforce Attack**:
    `john --wordlist=/usr/share/wordlists/rockyou.txt kay.hash`
    - **Why?**: John tests every word in the `rockyou.txt` list to see if it unlocks the hash.

```
result
```


    - **The passphrase is `beeswax`.**

**Reconnect as kay **

```
result
```

**Post-Exploitation Discovery (Kay)**:

The `pass.bak` file contains: `heresareallystrongpasswordthatfollowsthepasswordpolicy$$`

```
result
```

**Analysis**:

This looks like a very strong password. It's probably `kay`'s password for `sudo` or directly `root`'s password.

## Step 4: Privilege Escalation (Root)

**Testing the Password**:

We try this password to become administrator via `sudo`.

**Command**: `sudo -l` (then enter the password)

**Why?**:

- `sudo`: "SuperUser DO". Allows executing commands with administrator privileges.
- `-l`: "List". We ask sudo to list everything we are allowed to do.

```
result
```
- *Result*: If the command displays `(ALL : ALL) ALL` or similar, we've won: we can do everything.

To read the flag: `sudo cat /root.txt`

```
result
```

**Final Result**:

```text

Congratulations! You've completed this challenge. There are two ways (that I'm aware of) to gain

a shell, and two ways to privesc. I encourage you to find them all!

...

```

## Conclusion

We successfully compromised the machine starting from scratch:

1.  **Reconnaissance**: Discovered ports 80 (Web) and 445 (SMB).
2.  **Enumeration**: Identified users (`jan`, `kay`) and weak passwords via forgotten configuration files and notes.
3.  **Exploitation**: SSH brute-force to enter as `jan`.
4.  **Privilege Escalation**: Stole a poorly protected SSH key to become `kay`, then discovered a password in a backup file to become `root`.

This is the end of the Basic Pentesting CTF.


by:
```
â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«   â«â«â«â«â«â«â«â«â«â«â«â«â«â«â« â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«   â«â«â«â«â«â«â«â«â«â«â«â«â«â«â« â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«   â«â«â«â«â«â«â«â«â«â«â«â«â«â«â« â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«   â«â«â«â«â«â«â«â«â«â«â«â«â«â«â« â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â« â«â«â«â«â«â«â«â«â«â«â« â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«   â«â«â«â«â«â«â«â«â«â«â«â«â«â«â« â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«   â«â«â«â«â«â«â«â«â«â«â«â«â«â«â« â«â«â«â«â«â«â«â«â«â«â«â«â«â«â«     moi_404
```
## ğŸ“± Follow me

[![LinkedIn](https://cdn-icons-png.flaticon.com/24/174/174857.png)](https://www.linkedin.com/in/wilsontessoh)
[![Facebook](https://cdn-icons-png.flaticon.com/24/733/733547.png)]([https://www.facebook.com/tonprofil](https://www.facebook.com/people/Wilson-Tessoh/61585829171377/))
[![Instagram](https://cdn-icons-png.flaticon.com/24/2111/2111463.png)]([https://www.instagram.com/tonprofil](https://www.instagram.com/wilson_tessoh/))

